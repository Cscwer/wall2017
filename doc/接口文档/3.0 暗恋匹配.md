2.0 暗恋匹配

本文件重在讲述 暗恋匹配 的逻辑以及相关接口 

# 数据库设计 

新建了一个 Schema 用于约束

``` js
let taSchema = mongoose.Schema({
    from: {
        type: mongoose.Schema.Types.ObjectId,
        ref: 'user', 
        required: true, 
        unique: true
    }, 
    to: {
        type: mongoose.Schema.Types.ObjectId,
        ref: 'user', 
        required: true
    }, 
    created_at: {
        type: Date, 
        default: Date.now
    }
});
```

# 逻辑解释 

现有两人 A B，只要他们同时互相暗恋，即匹配成功，详细的、所有的、不重复的情况如下： 

1. A 暗恋 B，B 也暗恋 A，匹配成功 
2. A 暗恋 B，B 却不暗恋 A，匹配失败
3. A 没有暗恋任何人，B 也是，匹配失败

而且，还需要搜索用户，据此设计如下接口 :

1. `GET  /api/ta`
2. `POST /api/ta`
3. `GET /api/pingpong`


# 接口说明

> 相关文件 `./server/routes/ta.js` , `./server/routes/user.js`

## GET /api/ta 

**[ TIP ]** 返回用户暗恋的人的信息 

**[ PARAM ]** 无须参数，直接调用 

**[ RESPONSE ]** 返回值参考 user 表, 比如： 

``` json
{
    "code": 2000,
    "data": {
        "_id": "59ce8acd6323dc1764274869",
        "to": {
            "_id": "59ce82b6013ab732301dc8d7",
            "openid": "002-openid-fake",
            "nickname": "我是eczn的爱人",
            "sex": 0,
            "headimgurl": "http://wx.qlogo.cn/mmopen/vi_32/sBlxQJd2SyVeyroibMblibJyoINHpLnfPwGDib8mNzfMibAsrdxeSOyYqOtYjrglx04mJ2TeM3Pr4juMKjpHJJFcZA/0",
            "__v": 0,
            "created_at": "2017-09-29T17:28:22.850Z",
            "phone": "未设置"
        },
        "from": {
            "_id": "59ce826c4fece5203cd318c7",
            "openid": "opdbdwdWXWMg9UY72Z4i_DTcblR0",
            "nickname": "eczn",
            "sex": 0,
            "headimgurl": "http://wx.qlogo.cn/mmopen/vi_32/sBlxQJd2SyVeyroibMblibJyoINHpLnfPwGDib8mNzfMibAsrdxeSOyYqOtYjrglx04mJ2TeM3Pr4juMKjpHJJFcZA/0",
            "__v": 0,
            "created_at": "2017-09-29T17:27:08.773Z",
            "phone": "未设置"
        },
        "__v": 0,
        "created_at": "2017-09-29T18:02:53.726Z"
    },
    "msg": "接口调用成功"
}
```

## POST /api/ta 

**[ TIP ]** 在未设置过用户所爱之人的情况下设置它的所爱之人 

**[ PARAM ]** 需要参数，字段如下： 

| to            |
| ------------- |
| 被爱之人的 _id |

``` js
http.post('/api/ta', {
    ta: 'xxxxx'
})
```


没写完。。 夜深了 睡觉